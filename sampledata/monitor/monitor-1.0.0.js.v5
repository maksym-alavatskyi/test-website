!function(){!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ClickTaleMonitor=t()}}(function(){return function t(e,i,r){function n(s,c){if(!i[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var p=i[s]={exports:{}};e[s][0].call(p.exports,function(t){var i=e[s][1][t];return n(i?i:t)},p,p.exports,t,e,i,r)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,i){"use strict";var r=t("../eventHubs/Hub"),n=t("../ioc/Container"),o=t("../metrics/IdMetric"),s=t("../config/Configuration"),c=t("../services/disposer/Disposer"),a=t("../metrics/MetricsReader"),u=t("../metrics/VersionMetric"),p=t("../metrics/BrowserMetric"),f=t("../metrics/EventIdsMetric"),h=t("../metrics/LocationMetric"),l=t("../metrics/MetricsPromise"),v=t("../messaging/JSONSerializer"),y=t("../metrics/AttentionMetric"),d=t("../metrics/ProjectIdMetric"),m=t("../metrics/TimeOnPageMetric"),g=t("../metrics/MetricAggregator"),M=t("../metrics/ScrollReachMetric"),b=t("../services/idGenerator/IdGenerator"),w=t("../metrics/IsNewVisitorMetric"),T=t("../metrics/JSErrorCountMetric"),I=t("../services/cookies/CookiesService"),E=t("../metrics/CompositeInactivity"),A=t("../metrics/BrowserVersionMetric"),O=t("../metrics/LackOfInterestMetric"),S=t("../metrics/NumberOfClicksMetric"),C=t("../transport/XhrTransportChannel"),x=t("../metrics/ResolutionWidthMetric"),R=t("../distribution/DistributionService"),k=t("../services/userAgent/UserAgentService"),V=t("../messaging/QueryStringSerializer"),P=t("../transport/ImageTransportChannel"),D=t("../metrics/DocumentReferrerMetric"),j=t("../metrics/PeriodicalNotifierRule"),N=t("../metrics/ResolutionHeightMetric"),L=t("../transport/BeaconTransportChannel"),H=t("../services/callbackInvoker/CallbackInvoker"),F=t("../metrics/VisitIdentificationMetric"),z=t("../metrics/DOMLContentLoadedTimeMetric"),_=t("../metrics/VisitorIdentificationMetric"),B=t("../metrics/PageViewIdentificationMetric"),G=t("../services/identification/IdentificationService"),U=t("../metrics/EngagementTimeAggregatorMetric"),q=function(){function t(t){var e=this;this.projectId=t,this.bootstrap(function(){e.tryRegisterComponents()&&e.start()})}return t.prototype.bootstrap=function(e){if(!t.isMonitoring){if(/complete|interactive/.test(document.readyState))return e();document.addEventListener("DOMContentLoaded",e,!1)}},t.prototype.start=function(){var e=t.container.resolve("Disposer");t.isMonitoring=!0,t.container.resolve("Hub"),t.container.resolve("CompositeInactivity"),t.container.resolve("MetricsReader"),t.container.resolve("DistributionService"),e.metricAggregator=t.container.resolve("MetricAggregator"),H.CallbackInvoker.invoke("ClickTaleMonitorOnStart")},t.prototype.tryRegisterComponents=function(){var e=this,i=new k.UserAgentService;return i.isBrowserSupported?(t.container=new n.Container,this.eventRepository=new f.EventIdsMetric,t.container.register("Hub",function(t){return new r.Hub(i)}),t.container.registerInstance(i),t.registerTransportChannels(i.userAgent,s.Configuration),t.container.register("IdGenerator",function(t){return new b.IdGenerator}),t.container.register("VersionMetric",function(t){return new u.VersionMetric}),t.container.register("LocationMetric",function(t){return new h.LocationMetric}),t.container.register("CookiesService",function(t){return new I.CookiesService}),t.container.register("BrowserMetric",function(t){return new p.BrowserMetric(i)}),t.container.register("ResolutionWidthMetric",function(t){return new x.ResolutionWidthMetric}),t.container.registerNamedInstance("EventIdsMetric",this.eventRepository),t.container.register("ProjectIdMetric",function(t){return new d.ProjectIdMetric(e.projectId)}),t.container.register("DocumentReferrerMetric",function(t){return new D.DocumentReferrerMetric}),t.container.register("ResolutionHeightMetric",function(t){return new N.ResolutionHeightMetric}),t.container.register("IdMetric",function(t,e){return new o.IdMetric(e)}).asTransient(),t.container.register("AttentionMetric",function(t){return new y.AttentionMetric(performance.timing)}),t.container.register("BrowserVersionMetric",function(t){return new A.BrowserVersionMetric(i)}),t.container.register("ScrollReachMetric",function(t){return new M.ScrollReachMetric(t.resolve("Hub"))}),t.container.register("JSErrorCountMetric",function(t){return new T.JSErrorCountMetric(t.resolve("Hub"))}),t.container.register("LackOfInterestMetric",function(t){return new O.LackOfInterestMetric(performance.timing)}),t.container.register(s.Configuration.transport.mainChannel+" serializer",function(t){return new v.JSONSerializer}),t.container.register("NumberOfClicksMetric",function(t){return new S.NumberOfClicksMetric(t.resolve("Hub"))}),t.container.register("PeriodicalNotifierRule",function(t){return new j.PeriodicalNotifierRule(s.Configuration)}),t.container.register(s.Configuration.transport.terminalChannel+" serializer",function(t){return new V.QueryStringSerializer}),t.container.register("DOMLContentLoadedTimeMetric",function(t){return new z.DOMLContentLoadedTimeMetric(performance.timing)}),t.container.register("TimeOnPageMetric",function(t){return new m.TimeOnPageMetric(t.resolve("Hub"),performance.timing)}),t.container.register("Disposer",function(t){return new c.Disposer(t.resolve("Hub"),t,s.Configuration,e)}).ownedExternally(),t.container.register("MetricsPromise",function(t){return new l.MetricsPromise(t.resolve("MetricAggregator"))}),t.container.register("IsNewVisitorMetric",function(t){return new w.IsNewVisitorMetric(t.resolve("IdentificationService"))}),t.container.register("VisitIdentificationMetric",function(t){return new F.VisitIdentificationMetric(t.resolve("IdentificationService"))}),t.container.register("VisitorIdentificationMetric",function(t){return new _.VisitorIdentificationMetric(t.resolve("IdentificationService"))}),t.container.register("PageViewIdentificationMetric",function(t){return new B.PageViewIdentificationMetric(t.resolve("IdentificationService"))}),t.container.register("EngagementTimeAggregatorMetric",function(t){return new U.EngagementTimeAggregatorMetric(t.resolve("Hub"),s.Configuration,performance.timing)}),t.container.register("DistributionService",function(t){return new R.DistributionService(e,s.Configuration,t.resolve("Hub"),t,t.resolve("Disposer"))}),t.container.register("CompositeInactivity",function(t){return new E.CompositeInactivity(t.resolve("Hub"),t.resolve("LackOfInterestMetric"),t.resolve("AttentionMetric"))}),t.container.register("IdentificationService",function(t){return new G.IdentificationService(t.resolve("IdGenerator"),t.resolve("CookiesService"),s.Configuration)}),t.container.register("MetricAggregator",function(t){var e=s.Configuration.metrics.providers.map(function(e){return t.resolve(e)});return e=e.concat([t.resolve("VersionMetric"),t.resolve("LocationMetric"),t.resolve("ProjectIdMetric"),t.resolve("DocumentReferrerMetric"),t.resolve("VisitIdentificationMetric"),t.resolve("DOMLContentLoadedTimeMetric"),t.resolve("VisitorIdentificationMetric"),t.resolve("PageViewIdentificationMetric")]),new g.MetricAggregator(e,t.resolve("Hub"),s.Configuration,t.resolveFactory("IdMetric"),t.resolve("Disposer"))}),t.container.register("MetricsReader",function(t){var e=t.resolve("MetricsPromise");return new a.MetricsReader([e,t.resolve("PeriodicalNotifierRule")],t.resolve("Hub"),t.resolve("MetricAggregator"),t.resolve("DistributionService"),e,t.resolve("IdentificationService"))}),!0):!1},t.prototype.shutdown=function(){this.dispose(!0)},t.prototype.dispose=function(e){var i=t.container.resolve("Disposer");i.dispose(e)},t.prototype.stop=function(){t.isMonitoring=!1},t.prototype.isMonitoring=function(){return t.isMonitoring},t.prototype.setIdentification=function(e){var i=t.container.resolve("IdentificationService");i.setIdentification(e)},t.registerTransportChannels=function(e,i){var r=i.transport,n=(e.browser.type,e.supports.sendBeacon?L.BeaconTransportChannel:P.ImageTransportChannel);t.container.register(r.terminalChannel+" channel",function(t,e){return new n(e)}).ownedExternally(),t.container.register(r.mainChannel+" channel",function(t,e){return new C.TransportChannelXhr(e)}).asTransient().ownedExternally()},t.prototype.addEvent=function(t){this.eventRepository.addEvent(t)},t.isMonitoring=!1,t}();i.App=q},{"../config/Configuration":5,"../distribution/DistributionService":6,"../eventHubs/Hub":8,"../ioc/Container":9,"../messaging/JSONSerializer":14,"../messaging/QueryStringSerializer":15,"../metrics/AttentionMetric":21,"../metrics/BrowserMetric":22,"../metrics/BrowserVersionMetric":23,"../metrics/CompositeInactivity":24,"../metrics/DOMLContentLoadedTimeMetric":25,"../metrics/DocumentReferrerMetric":26,"../metrics/EngagementTimeAggregatorMetric":27,"../metrics/EventIdsMetric":28,"../metrics/IdMetric":29,"../metrics/IsNewVisitorMetric":30,"../metrics/JSErrorCountMetric":31,"../metrics/LackOfInterestMetric":32,"../metrics/LocationMetric":33,"../metrics/MetricAggregator":34,"../metrics/MetricsPromise":36,"../metrics/MetricsReader":37,"../metrics/NumberOfClicksMetric":38,"../metrics/PageViewIdentificationMetric":39,"../metrics/PeriodicalNotifierRule":40,"../metrics/ProjectIdMetric":41,"../metrics/ResolutionHeightMetric":42,"../metrics/ResolutionWidthMetric":43,"../metrics/ScrollReachMetric":44,"../metrics/TimeOnPageMetric":45,"../metrics/VersionMetric":46,"../metrics/VisitIdentificationMetric":47,"../metrics/VisitorIdentificationMetric":48,"../services/callbackInvoker/CallbackInvoker":49,"../services/cookies/CookiesService":50,"../services/disposer/Disposer":51,"../services/idGenerator/IdGenerator":52,"../services/identification/IdentificationService":53,"../services/userAgent/UserAgentService":55,"../transport/BeaconTransportChannel":57,"../transport/ImageTransportChannel":58,"../transport/XhrTransportChannel":59}],2:[function(t,e,i){"use strict";var r=t("./App");i.App=r.App},{"./App":1}],3:[function(t,e,i){"use strict";var r;!function(t){t[t.error=0]="error",t[t.keyup=1]="keyup",t[t.scroll=2]="scroll",t[t.resize=3]="resize",t[t.unload=4]="unload",t[t.online=5]="online",t[t.mouseup=6]="mouseup",t[t.offline=7]="offline",t[t.mousedown=8]="mousedown",t[t.mouseover=9]="mouseover",t[t.touchstart=10]="touchstart",t[t.beforeunload=11]="beforeunload",t[t.visibilitychange=12]="visibilitychange"}(r||(r={})),i.EventType=r},{}],4:[function(t,e,i){"use strict";var r=function(){function t(){}return t.prototype.add=function(t,e){this[t.toString()]=e},t.prototype.remove=function(t){delete this[t.toString()]},t.prototype.containsKey=function(t){return!!this[t.toString()]},t.prototype.tryGetValue=function(t,e){var i=this[t.toString()];return i?(e.out=i,!0):!1},t.prototype.clear=function(){var t=this;Object.keys(this).forEach(function(e){delete t[e]})},t.prototype.values=function(){var t=this;return Object.keys(this).map(function(e){return t[e]})},t}();i.Dictionary=r},{}],5:[function(t,e,i){"use strict";var r=t("../services/objectExtender/ObjectExtender"),n=window.ClickTaleMonitorSettings,o={metrics:{inactivityTime:2e4,maxFetchInterval:1e4,providers:["BrowserMetric","EventIdsMetric","TimeOnPageMetric","ScrollReachMetric","IsNewVisitorMetric","JSErrorCountMetric","NumberOfClicksMetric","BrowserVersionMetric","ResolutionWidthMetric","ResolutionHeightMetric","EngagementTimeAggregatorMetric"]},identification:{expirationDays:365,visitTimeSpan:18e5},transport:{url:"https://",mainChannel:"main",terminalChannel:"terminal"},distribution:{relaibleMessages:{retries:2,waitInterval:1e3}}};i.Configuration=o,o=r.ObjectExtender.extend(o,n)},{"../services/objectExtender/ObjectExtender":54}],6:[function(t,e,i){"use strict";var r=t("../eventHubs/EventType"),n=t("../collections/Dictionary"),o=function(){function t(t,e,i,o,s){var c=this;this.app=t,this.config=e,this.hub=i,this.container=o,this.channelFactory=s,this.isBrowserOnline=!1,this.envelopeMap=new n.Dictionary,this.transportUrl=e.transport.url,this.channelSettings={sendPromise:{reject:this.onTransportFailure,resolve:this.onTransportSuccess},waitInterval:e.distribution.relaibleMessages.waitInterval},this.isBrowserOnline=navigator.onLine,this.hub.bind([r.EventType.online,r.EventType.offline],function(){return c.isBrowserOnline=navigator.onLine})}return t.prototype.process=function(t,e){var i,r={data:t},n={};if(e.reliable&&this.envelopeMap.tryGetValue(e.id,n)){if(i=n.out,--i.retries<0)return this.app.shutdown()}else i={message:r,metrics:e,retries:this.config.distribution.relaibleMessages.retries},this.envelopeMap.add(e.id,i);this.distributeEnvelope(i)},t.prototype.distributeEnvelope=function(t){if(this.isBrowserOnline){var e=this.transportUrl+"?t="+t.metrics.type,i=this.channelFactory.getChannel(this.channelSettings);i.send(e,t)}},t.prototype.onTransportSuccess=function(t){t.metrics.promise.resolve(t.metrics)},t.prototype.onTransportFailure=function(t){t.metrics.promise.reject(t.metrics)},t}();i.DistributionService=o},{"../collections/Dictionary":4,"../eventHubs/EventType":7}],7:[function(t,e,i){arguments[4][3][0].apply(i,arguments)},{dup:3}],8:[function(t,e,i){"use strict";var r=t("../eventHubs/EventType"),n=t("../collections/Dictionary"),o=function(){function t(t){this.userAgentService=t,this.bindedPublish=this.publish.bind(this),this.subscribers=new n.Dictionary,this.documentEvents=[r.EventType.mousedown,r.EventType.mouseover,r.EventType.mouseup,r.EventType.keyup,r.EventType.visibilitychange],this.userEvents=[r.EventType.mouseover,r.EventType.mouseup,r.EventType.keyup,r.EventType.scroll,r.EventType.resize],this.windowEvents=[r.EventType.scroll,r.EventType.resize,r.EventType.online,r.EventType.offline,r.EventType.error,r.EventType.beforeunload,r.EventType.unload],this.init()}return t.prototype.init=function(){var t=this;this.userAgentService.userAgent.is.mobile&&(this.userEvents.push(r.EventType.touchstart),this.documentEvents.push(r.EventType.touchstart)),this.documentEvents.concat(this.windowEvents).forEach(function(e){t.subscribers[e]=new Array}),this.bindBrowserEvents()},t.prototype.bind=function(t,e){this.bindInternal(t,e)},t.prototype.unbind=function(t,e){var i=this;t.forEach(function(t){if(i.subscribers){var r=i.subscribers[t],n=r.indexOf(e);n>-1&&r.splice(n,1)}})},t.prototype.bindTop=function(t,e){this.bindInternal(t,e,!0)},t.prototype.bindInternal=function(t,e,i){var r=this;void 0===i&&(i=!1);var n=i?function(t){return t.splice(0,0,e)}:function(t){return t.push(e)};t.forEach(function(t){return n(r.subscribers[t])})},t.prototype.unbindAll=function(){this.subscribers=null},t.prototype.publish=function(t){var e=r.EventType[t.type];this.subscribers[e].forEach(function(e){return e(t)})},t.prototype.dispose=function(t){this.unbindAll(),this.unbindBrowserEvents()},t.prototype.bindBrowserEvents=function(){var t=function(t){return t.addEventListener};this.bindUnbindBrowserEvent(t,window,this.windowEvents,this.bindedPublish),this.bindUnbindBrowserEvent(t,document,this.documentEvents,this.bindedPublish)},t.prototype.unbindBrowserEvents=function(){var t=function(t){return t.removeEventListener};this.bindUnbindBrowserEvent(t,window,this.windowEvents,this.bindedPublish),this.bindUnbindBrowserEvent(t,document,this.documentEvents,this.bindedPublish)},t.prototype.bindUnbindBrowserEvent=function(t,e,i,n){i.forEach(function(i){var o=r.EventType[i],s=t(e);s.apply(e,[o,n,!1])})},t}();i.Hub=o},{"../collections/Dictionary":4,"../eventHubs/EventType":7}],9:[function(t,e,i){"use strict";var r=t("./ServiceKey"),n=t("../collections/Dictionary"),o=t("./GenericServiceEntry"),s=function(){function t(){this.defaultOwner=0,this.defaultReuse=0,this.disposables=new Array,this.services=new n.Dictionary;var e=o.GenericServiceEntry.build({instance:this,factory:function(t){return t},container:this,owner:1,reuse:0});this.services.add(new r.ServiceKey(t),e)}return t.prototype.dispose=function(t){for(;this.disposables.length>0;){var e=this.disposables.shift();e.dispose(t)}},t.prototype.register=function(t,e){return this.registerNamed(t,null,e)},t.prototype.registerInstance=function(t){this.registerNamedInstance(null,t)},t.prototype.registerNamedInstance=function(t,e){var i=Object.getPrototypeOf(e),r=i.constructor,n=this.registerImpl(r,t,null);n.asSingleton().ownedExternally(),n.initializeInstance(e)},t.prototype.registerNamed=function(t,e,i){return this.registerImpl(t,e,i)},t.prototype.registerImpl=function(t,e,i){var n=new r.ServiceKey(t,e),s=o.GenericServiceEntry.build({container:this,factory:i,reuse:this.defaultReuse,owner:this.defaultOwner});return this.services.add(n,s),s},t.prototype.resolve=function(t,e,i,r,n){var o=[t,null,e,i,r,n];return this.resolveNamed.apply(this,o)},t.prototype.resolveNamed=function(t,e,i,r,n,o){var s=Array.prototype.slice.call(arguments,2);return this.resolveImpl(t,e,s)},t.prototype.resolveFactory=function(t){return this.resolveNamedFactory(t,null)},t.prototype.resolveNamedFactory=function(t,e){var i,r=this.getEntry(t,e);return r?function(t,e,n,o){var s=[r.container,t,e,n,o];return i=r.instance,i||(i=r.factory.apply(null,s),r.initializeInstance(i)),i}:function(){return null}},t.prototype.resolveImpl=function(t,e,i){var r,n=this.getEntry(t,e);return n?(r=n.instance,r||(i=i||[],i.splice(0,0,n.container),r=n.factory.apply(null,i),n.initializeInstance(r)),r):null},t.prototype.getEntry=function(t,e){var i,n=new r.ServiceKey(t,e),o={};return this.services.tryGetValue(n,o)&&(i=o.out),i},t.prototype.trackDisposable=function(t){this.disposables.push(t)},t}();i.Container=s},{"../collections/Dictionary":4,"./GenericServiceEntry":10,"./ServiceKey":13}],10:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./ServiceEntry"),o=function(t){function e(e){t.call(this),this.factory=e}return r(e,t),e.prototype.initializeInstance=function(t){var e=t;1!==this.reuse&&(this.instance=t),0===this.owner&&e.dispose&&this.container.trackDisposable(e),this.initializer&&this.initializer(this.container,t)},e.prototype.initializedBy=function(t){return this.initializer=t,this},e.prototype.cloneFor=function(t){return e.build({reuse:this.reuse,owner:this.owner,factory:this.factory,container:t,initializer:this.initializer})},e.build=function(t){var i=new e(t.factory);return i.owner=t.owner,i.reuse=t.reuse,i.instance=t.instance,i.container=t.container,i.initializer=t.initializer,i},e}(n.ServiceEntry);i.GenericServiceEntry=o},{"./ServiceEntry":12}],11:[function(t,e,i){"use strict";var r=function(){function t(){}return t.resolve=function(e){var i=e;return"string"==typeof e?e:i.name||t.resolveByCode(i)},t.resolveByCode=function(e){var i=e.toString().match(t.nameRegex);return i&&i.length>0&&i[1]||t.resolveByPrototype(e)},t.resolveByPrototype=function(t){var e=new Array,i=t.prototype;for(var r in i)e.push(r);return e.join("")},t.nameRegex=/function ([^\(]+)/,t}();i.NameResolver=r},{}],12:[function(t,e,i){"use strict";var r=function(){function t(){}return t.prototype.ownedByContainer=function(){this.owner=0},t.prototype.ownedExternally=function(){return this.owner=1,this},t.prototype.asSingleton=function(){return this.reuse=0,this},t.prototype.asTransient=function(){return this.reuse=1,this},t}();i.ServiceEntry=r},{}],13:[function(t,e,i){"use strict";var r=t("./NameResolver"),n=function(){function t(t,e){this.ctor=t,this.serviceName=e,this.key=e||r.NameResolver.resolve(t)}return t.prototype.toString=function(){return this.key},t}();i.ServiceKey=n},{"./NameResolver":11}],14:[function(t,e,i){"use strict";var r=t("../metrics/MetricType"),n=function(){function t(){}return t.prototype.serialize=function(t){var e={};return t.forEach(function(t){return e[r.MetricType[t.type]]=t.value}),JSON.stringify(e)},t}();i.JSONSerializer=n},{"../metrics/MetricType":35}],15:[function(t,e,i){"use strict";var r=function(){function t(){}return t.prototype.serialize=function(t){var e=[];return t.forEach(function(t){e.push(t.type+"="+encodeURIComponent(t.value))}),e.join("&")},t}();i.QueryStringSerializer=r},{}],16:[function(t,e,i){"use strict";var r=function(){function t(t){this.isLast=!1,this.oneTime=!1,this.inactivityDetectedTime=0,this.inactivityDetected=!1,this.inactivityAggregatedTime=0,this.navigationStart=t.navigationStart}return t.prototype.tryAccumulateInactivityTime=function(){var t=Date.now();this.inactivityDetected&&(this.inactivityAggregatedTime+=t-this.inactivityDetectedTime,this.inactivityDetectedTime=t)},t.prototype.markActivity=function(){this.tryAccumulateInactivityTime(),this.inactivityDetected=!1},t.prototype.markInactivity=function(){this.inactivityDetected=!0,this.inactivityDetectedTime=Date.now()},t.prototype.getMetric=function(){return this.tryAccumulateInactivityTime(),{type:this.getMetricType(),value:Date.now()-this.navigationStart-this.inactivityAggregatedTime}},t}();i.AbstractActivityMetric=r},{}],17:[function(t,e,i){"use strict";var r=function(){function t(){}return t.prototype.registerNotification=function(t){return this.callback=t,this},t.prototype.notify=function(){this.callback()},t}();i.AbstractEventRule=r},{}],18:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./AbstractMetric"),o=function(t){function e(e){t.call(this,!0,!1),this.identification=e.getIdentification()}return r(e,t),e}(n.AbstractMetric);i.AbstractIdentificationMetric=o},{"./AbstractMetric":20}],19:[function(t,e,i){"use strict";var r=function(){function t(t){this.isLast=!1,this.oneTime=!1,this.minInactivityValue=Math.pow(2,53)-1,this.navigationStart=t.navigationStart,this.inactivityCounter=this.inactivitySum=this.minInactivityValue=this.maxInactivityValue=0}return t.prototype.calculateInactivity=function(t){Date.now()-this.navigationStart<500||(this.inactivityCounter++,this.lastActivityTime=t,this.inactivitySum=this.inactivitySum+this.lastActivityTime,this.minInactivityValue=Math.min(this.lastActivityTime,this.minInactivityValue),this.maxInactivityValue=Math.max(this.lastActivityTime,this.maxInactivityValue))},t.prototype.getMetric=function(){return{type:this.getMetricType(),value:{sum:this.inactivitySum,max:this.maxInactivityValue,min:this.minInactivityValue,count:this.inactivityCounter}}},t}();i.AbstractInactivityMetric=r},{}],20:[function(t,e,i){"use strict";var r=function(){function t(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0),this.isLast=t,this.oneTime=e}return t.prototype.getMetric=function(){return{type:this.type,value:this.getMetricValue()}},t}();i.AbstractMetric=r},{}],21:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractInactivityMetric"),s=function(t){function e(e){t.call(this,e)}return r(e,t),e.prototype.getMetricType=function(){return n.MetricType.attention},e}(o.AbstractInactivityMetric);i.AttentionMetric=s},{"./AbstractInactivityMetric":19,"./MetricType":35}],22:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(e){t.call(this),this.type=n.MetricType.browser,this.userAgent=e.userAgent}return r(e,t),e.prototype.getMetricValue=function(){return this.userAgent.browser.name},e}(o.AbstractMetric);i.BrowserMetric=s},{"./AbstractMetric":20,"./MetricType":35}],23:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(e){t.call(this),this.type=n.MetricType.browserVersion,this.userAgent=e.userAgent}return r(e,t),e.prototype.getMetricValue=function(){return this.userAgent.browser.version},e}(o.AbstractMetric);i.BrowserVersionMetric=s},{"./AbstractMetric":20,"./MetricType":35}],24:[function(t,e,i){"use strict";var r=function(){function t(t,e,i){this.hub=t,this.lackOfInterestMetric=e,this.attentionMetric=i,this.lastActivityDetectedTime=Date.now(),this.hub.bind(t.userEvents,this.onEventRaised.bind(this))}return t.prototype.onEventRaised=function(t){this.updateMetric()},t.prototype.updateMetric=function(){var t=Date.now(),e=t-this.lastActivityDetectedTime;1e3>=e?this.lackOfInterestMetric.calculateInactivity(e):e>1e3&&5e3>e&&this.attentionMetric.calculateInactivity(e),this.lastActivityDetectedTime=t},t}();i.CompositeInactivity=r},{}],25:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(e){t.call(this),this.timing=e,this.isLast=!1,this.oneTime=!0,this.type=n.MetricType.domContentLoaded}return r(e,t),e.prototype.getMetricValue=function(){return this.timing.domContentLoadedEventEnd-this.timing.navigationStart},e}(o.AbstractMetric);i.DOMLContentLoadedTimeMetric=s},{"./AbstractMetric":20,"./MetricType":35}],26:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(){t.apply(this,arguments),this.type=n.MetricType.documentReferrer}return r(e,t),e.prototype.getMetricValue=function(){return document.referrer},e}(o.AbstractMetric);i.DocumentReferrerMetric=s},{"./AbstractMetric":20,"./MetricType":35}],27:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractActivityMetric"),s=function(t){function e(e,i,r){t.call(this,r),this.hub=e,this.config=i,this.intervalId=0,this.hub.bind(e.userEvents,this.onEventRaised.bind(this)),this.guardInactivityTime()}return r(e,t),e.prototype.getMetricType=function(){return n.MetricType.engagementTime},e.prototype.guardInactivityTime=function(){var t=this;clearTimeout(this.intervalId),this.intervalId=setTimeout(function(){t.markInactivity()},this.config.metrics.inactivityTime)},e.prototype.onEventRaised=function(t){this.markActivity(),this.guardInactivityTime()},e.prototype.dispose=function(t){clearTimeout(this.intervalId)},e}(o.AbstractActivityMetric);i.EngagementTimeAggregatorMetric=s},{"./AbstractActivityMetric":16,"./MetricType":35}],28:[function(t,e,i){"use strict";var r=t("./MetricType"),n=function(){function t(){this.isLast=!1,this.oneTime=!1,this.eventsArray=[]}return t.prototype.addEvent=function(t){-1===this.eventsArray.indexOf(t)&&this.eventsArray.push(t)},t.prototype.getMetric=function(){return{value:this.eventsArray,type:r.MetricType.eventIds}},t}();i.EventIdsMetric=n},{"./MetricType":35}],29:[function(t,e,i){"use strict";var r=t("./MetricType"),n=function(){function t(t){this.id=t,this.isLast=!0,this.oneTime=!1}return t.prototype.getMetric=function(){return{value:this.id,type:r.MetricType.messageId}},t}();i.IdMetric=n},{"./MetricType":35}],30:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(e){t.call(this),this.identificationService=e,this.type=n.MetricType.isNewVisitor}return r(e,t),e.prototype.getMetricValue=function(){return this.identificationService.isNewIdentification},e}(o.AbstractMetric);i.IsNewVisitorMetric=s},{"./AbstractMetric":20,"./MetricType":35}],31:[function(t,e,i){"use strict";var r=t("./MetricType"),n=t("../eventHubs/EventType"),o=function(){function t(t){this.hub=t,this.isLast=!1,this.oneTime=!1,this.jsErrorCounter=0,this.hub.bind([n.EventType.error],this.onEventRaised.bind(this))}return t.prototype.onEventRaised=function(t){this.jsErrorCounter++},t.prototype.getMetric=function(){return{value:this.jsErrorCounter,type:r.MetricType.jsErrorCount}},t}();i.JSErrorCountMetric=o},{"../eventHubs/EventType":7,"./MetricType":35}],32:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractInactivityMetric"),s=function(t){function e(e){t.call(this,e)}return r(e,t),e.prototype.getMetricType=function(){return n.MetricType.lackOfInterest},e}(o.AbstractInactivityMetric);i.LackOfInterestMetric=s},{"./AbstractInactivityMetric":19,"./MetricType":35}],33:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(){t.apply(this,arguments),this.type=n.MetricType.location}return r(e,t),e.prototype.getMetricValue=function(){return location.href},e}(o.AbstractMetric);i.LocationMetric=s},{"./AbstractMetric":20,"./MetricType":35}],34:[function(t,e,i){"use strict";var r=t("../eventHubs/EventType"),n=function(){function t(t,e,i,n,o){var s=this;this.metrics=t,this.config=i,this.idMetricFactory=n,this.serializableFactory=o,this.reliable=!0,this.metricCounter=0,this.messageType=0,this.serilaizer=o.getSerializer(),e.bindTop([r.EventType.beforeunload,r.EventType.unload],function(){s.terminate()})}return t.prototype.terminate=function(){this.messageType=2,this.serilaizer=this.serializableFactory.getSerializer(),this.metrics=this.metrics.filter(function(t){return t.isLast})},t.prototype.getMetrics=function(){var t,e=this.getMetricId(),i=this.idMetricFactory(e);return t=this.metrics.concat([i]),{id:e,type:this.messageType,reliable:this.reliable,metrics:this.serilaizer.serialize(t.map(function(t){return t.getMetric()}))}},t.prototype.resolveMetrics=function(t){t.reliable&&(this.reliable=!1,this.messageType=1,this.metrics=this.metrics.filter(function(t){return!t.oneTime}))},t.prototype.getMetricId=function(){return this.reliable?this.metricCounter:++this.metricCounter},t}();i.MetricAggregator=n},{"../eventHubs/EventType":7}],35:[function(t,e,i){"use strict";var r;!function(t){t[t.visitId=3]="visitId",t[t.version=6]="version",t[t.screenX=16]="screenX",t[t.screenY=17]="screenY",t[t.browser=18]="browser",t[t.location=7]="location",t[t.visitorId=2]="visitorId",t[t.projectId=1]="projectId",t[t.messageId=5]="messageId",t[t.eventIds=21]="eventIds",t[t.pageviewId=4]="pageviewId",t[t.timestamp=31]="timestamp",t[t.attention=32]="attention",t[t.timeOnPage=12]="timeOnPage",t[t.numOfClicks=14]="numOfClicks",t[t.scrollReach=13]="scrollReach",t[t.jsErrorCount=11]="jsErrorCount",t[t.isNewVisitor=20]="isNewVisitor",t[t.engagementTime=9]="engagementTime",t[t.lackOfInterest=30]="lackOfInterest",t[t.browserVersion=19]="browserVersion",t[t.documentReferrer=8]="documentReferrer",t[t.domContentLoaded=10]="domContentLoaded",t[t.durationSinceLastVisit=15]="durationSinceLastVisit"}(r||(r={})),i.MetricType=r},{}],36:[function(t,e,i){
"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./AbstractEventRule"),o=function(t){function e(e){t.call(this),this.metricsAggregator=e,this.started=!1}return r(e,t),e.prototype.resolve=function(t){this.metricsAggregator.resolveMetrics(t)},e.prototype.reject=function(t){t.reliable&&this.started&&this.notify()},e.prototype.start=function(){this.started=!0},e.prototype.stop=function(){this.started=!1},e}(n.AbstractEventRule);i.MetricsPromise=o},{"./AbstractEventRule":17}],37:[function(t,e,i){"use strict";var r=t("../eventHubs/EventType"),n=function(){function t(t,e,i,n,o,s){var c=this;this.notificationRules=t,this.hub=e,this.metricsAggregator=i,this.processor=n,this.promise=o,this.identificationService=s,t.forEach(function(t){return t.registerNotification(c.read.bind(c)).start()}),this.hub.bind([r.EventType.online,r.EventType.offline],function(){c.applyOnNotificationRules(function(t){return navigator.onLine?t.start():t.stop()})})}return t.prototype.read=function(){var t=this.metricsAggregator.getMetrics();t.isEmpty||(this.identificationService.modifyIdentification(),this.processor.process(t.metrics,{id:t.id,promise:this.promise,type:t.type,reliable:t.reliable}))},t.prototype.dispose=function(t){t||this.read(),this.applyOnNotificationRules(function(t){return t.stop()})},t.prototype.applyOnNotificationRules=function(t){this.notificationRules.forEach(function(e){return t(e)})},t}();i.MetricsReader=n},{"../eventHubs/EventType":7}],38:[function(t,e,i){"use strict";var r=t("./MetricType"),n=t("../EventHubs/EventType"),o=function(){function t(t){this.hub=t,this.isLast=!1,this.oneTime=!1,this.clicksCounter=0,this.hub.bind([n.EventType.mouseup],this.onMouseUpEventRaised.bind(this)),this.hub.bind([n.EventType.mousedown],this.onMouseDownEventRaised.bind(this))}return t.prototype.onMouseDownEventRaised=function(t){this.mouseDownEventTarget=t.target},t.prototype.onMouseUpEventRaised=function(t){this.mouseDownEventTarget===t.target&&this.clicksCounter++},t.prototype.getMetric=function(){return{value:this.clicksCounter,type:r.MetricType.numOfClicks}},t}();i.NumberOfClicksMetric=o},{"../EventHubs/EventType":3,"./MetricType":35}],39:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractIdentificationMetric"),s=function(t){function e(e){t.call(this,e),this.type=n.MetricType.pageviewId}return r(e,t),e.prototype.getMetricValue=function(){return this.identification.PageView},e}(o.AbstractIdentificationMetric);i.PageViewIdentificationMetric=s},{"./AbstractIdentificationMetric":18,"./MetricType":35}],40:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./AbstractEventRule"),o=function(t){function e(e){t.call(this),this.config=e,this.firstFibNumber=0,this.secondFibNumber=1,this.maxIntervalReached=!1,this.maxFetchInterval=this.config.metrics.maxFetchInterval}return r(e,t),e.prototype.start=function(){var t=this,e=this.maxIntervalReached?this.maxFetchInterval:this.getFetchInterval();this.timeoutId=setTimeout(function(){t.notify(),t.start()},e)},e.prototype.stop=function(){clearInterval(this.timeoutId)},e.prototype.dispose=function(t){this.stop()},e.prototype.getFetchInterval=function(){var t=this.firstFibNumber+this.secondFibNumber,e=1e3*t;return e>this.maxFetchInterval?(this.maxIntervalReached=!0,this.maxFetchInterval):(this.firstFibNumber=this.secondFibNumber,this.secondFibNumber=t,e)},e}(n.AbstractEventRule);i.PeriodicalNotifierRule=o},{"./AbstractEventRule":17}],41:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(e){t.call(this,!0,!1),this.projectId=e,this.type=n.MetricType.projectId}return r(e,t),e.prototype.getMetricValue=function(){return this.projectId},e}(o.AbstractMetric);i.ProjectIdMetric=s},{"./AbstractMetric":20,"./MetricType":35}],42:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(){t.apply(this,arguments),this.type=n.MetricType.screenY}return r(e,t),e.prototype.getMetricValue=function(){return window.innerHeight},e}(o.AbstractMetric);i.ResolutionHeightMetric=s},{"./AbstractMetric":20,"./MetricType":35}],43:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(){t.apply(this,arguments),this.type=n.MetricType.screenX}return r(e,t),e.prototype.getMetricValue=function(){return window.innerWidth},e}(o.AbstractMetric);i.ResolutionWidthMetric=s},{"./AbstractMetric":20,"./MetricType":35}],44:[function(t,e,i){"use strict";var r=t("./MetricType"),n=t("../eventHubs/EventType"),o=function(){function t(t){this.hub=t,this.isLast=!1,this.oneTime=!1,this.bindedOnEventRaised=this.onEventRaised.bind(this),this.maxScrollReach=0,this.hub.bind([n.EventType.scroll,n.EventType.resize],this.bindedOnEventRaised)}return t.prototype.onEventRaised=function(t){var e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=document.documentElement.scrollTop||document.body.scrollTop,r=document.documentElement.scrollHeight||document.body.scrollHeight,o=i/(r-e)*100;o=Math.abs(Math.round(Math.min(100,o))),this.maxScrollReach=Math.max(o,this.maxScrollReach),100===this.maxScrollReach&&this.hub.unbind([n.EventType.scroll,n.EventType.resize],this.bindedOnEventRaised)},t.prototype.getMetric=function(){return{value:this.maxScrollReach,type:r.MetricType.scrollReach}},t}();i.ScrollReachMetric=o},{"../eventHubs/EventType":7,"./MetricType":35}],45:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("../eventHubs/EventType"),s=t("./AbstractActivityMetric"),c=function(t){function e(e,i){t.call(this,i),this.hub=e,this.hub.bind([o.EventType.visibilitychange],this.onEventRaised.bind(this))}return r(e,t),e.prototype.getMetricType=function(){return n.MetricType.timeOnPage},e.prototype.onEventRaised=function(t){document.hidden?this.markInactivity():this.markActivity()},e}(s.AbstractActivityMetric);i.TimeOnPageMetric=c},{"../eventHubs/EventType":7,"./AbstractActivityMetric":16,"./MetricType":35}],46:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractMetric"),s=function(t){function e(){t.apply(this,arguments),this.type=n.MetricType.version}return r(e,t),e.prototype.getMetricValue=function(){return 1},e}(o.AbstractMetric);i.VersionMetric=s},{"./AbstractMetric":20,"./MetricType":35}],47:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractIdentificationMetric"),s=function(t){function e(e){t.call(this,e),this.type=n.MetricType.visitId}return r(e,t),e.prototype.getMetricValue=function(){return this.identification.Visit},e}(o.AbstractIdentificationMetric);i.VisitIdentificationMetric=s},{"./AbstractIdentificationMetric":18,"./MetricType":35}],48:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./MetricType"),o=t("./AbstractIdentificationMetric"),s=function(t){function e(e){t.call(this,e),this.type=n.MetricType.visitorId}return r(e,t),e.prototype.getMetricValue=function(){return this.identification.Visitor},e}(o.AbstractIdentificationMetric);i.VisitorIdentificationMetric=s},{"./AbstractIdentificationMetric":18,"./MetricType":35}],49:[function(t,e,i){"use strict";var r=function(){function t(){}return t.invoke=function(t,e){var i={args:[]};if("string"==typeof t){var r=self[t];if(!t)return;i.fn=r,i.scope=self}else"function"==typeof t?(i.fn=t,i.scope=self):"object"==typeof t&&t.hasOwnProperty("fn")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("args")&&(i=t);i.fn.apply(i.scope,i.args)},t}();i.CallbackInvoker=r},{}],50:[function(t,e,i){"use strict";var r=function(){function t(){}return t.prototype["delete"]=function(t){this.write(t,"",-1)},t.prototype.read=function(t){var e=0,i=0,r=document.cookie.split(";");t+="=";for(var n=0,o=r;n<o.length;n++){var s=o[n];if(0===s.trim().indexOf(t))return e=i+s.length,i=i+s.split("=")[0].length+1,document.cookie.substring(i,e);i+=s.length+1}return null},t.prototype.write=function(t,e,i){var r="";if(i){var n=new Date;n.setTime(n.getTime()+864e5*i),r="; expires="+n.toUTCString()}document.cookie=t+"="+e+r+"; path=/;"},t}();i.CookiesService=r},{}],51:[function(t,e,i){"use strict";var r=t("../../eventHubs/EventType"),n=function(){function t(t,e,i,n){var o=this;this.container=e,this.config=i,this.app=n;var s=this.dispose.bind(this);this.transportChannel=i.transport.mainChannel,setTimeout(s,i.identification.visitTimeSpan),t.bind([r.EventType.unload,r.EventType.beforeunload],function(){return o.dispose()}),this.channelFactory=this.resolveChannel(this.transportChannel)}return t.prototype.resolveChannel=function(t){return this.container.resolveFactory(t+" channel")},t.prototype.getSerializer=function(){return this.container.resolve(this.transportChannel+" serializer")},t.prototype.getChannel=function(t){return this.channelFactory(t)},t.prototype.dispose=function(t){this.transportChannel=this.config.transport.terminalChannel,this.metricAggregator.terminate(),this.channelFactory=this.resolveChannel(this.transportChannel),this.container.dispose(t),this.app.stop()},t.prototype.shutdown=function(){this.dispose(!0)},t}();i.Disposer=n},{"../../eventHubs/EventType":7}],52:[function(t,e,i){"use strict";var r=function(){function t(){}return t.prototype.generate=function(){return Math.floor(Math.random()*t.maxNumber)},t.maxNumber=Math.pow(2,53)-1,t}();i.IdGenerator=r},{}],53:[function(t,e,i){"use strict";var r=t("../objectExtender/ObjectExtender"),n=function(){function t(t,e,i){this.idGenerator=t,this.cookiesService=e,this.config=i,this.cookie="ctm",this.isNewIdentification=!1,this.setOrAddIdentification()}return t.prototype.setOrAddIdentification=function(){var t=this,e=!1,i=this.parseIdentification();i&&(e=this.persistIdentification(i,function(e){return t.isInVisitRange(i)||(i.vst=t.idGenerator.generate()),i.pgv=t.idGenerator.generate(),i.intr=Date.parse((new Date).toUTCString()),i})),e||this.createIdentification(),this.setIdentificationFromStored()},t.prototype.parseIdentification=function(){var t=this.cookiesService.read("ctm");if(t)try{return JSON.parse(t)}catch(e){}return null},t.prototype.setIdentificationFromStored=function(){this.identification={Visit:this.storedIdentification.vst,Visitor:this.storedIdentification.vstr,PageView:this.storedIdentification.pgv,LastModified:this.storedIdentification.intr}},t.prototype.getIdentification=function(){return this.identification},t.prototype.persistIdentification=function(t,e){return this.validate(t)?(t=e?e(t):t,this.updateCookie(t),this.storedIdentification=t,!0):!1},t.prototype.isInVisitRange=function(t){return Date.parse((new Date).toUTCString())-t.intr<this.config.identification.visitTimeSpan},t.prototype.createIdentification=function(){this.updateCookie(this.storedIdentification={pgv:this.idGenerator.generate(),vst:this.idGenerator.generate(),vstr:this.idGenerator.generate(),intr:Date.parse((new Date).toUTCString())}),this.isNewIdentification=!0},t.prototype.validate=function(t){return["vst","pgv","vstr","intr"].every(function(e){var i;return(i=t[e])?!isNaN(i):!1})},t.prototype.modifyIdentification=function(){var t=Date.parse((new Date).toUTCString());this.storedIdentification.intr=this.identification.LastModified=t,this.updateCookie(this.storedIdentification)},t.prototype.setIdentification=function(t){var e=this.parseIdentification()||{};e=r.ObjectExtender.extend(e,t),this.persistIdentification(e)&&this.setIdentificationFromStored()},t.prototype.updateCookie=function(t){var e=JSON.stringify(t);this.cookiesService.write(this.cookie,e,this.config.identification.expirationDays)},t}();i.IdentificationService=n},{"../objectExtender/ObjectExtender":54}],54:[function(t,e,i){"use strict";var r=function(){function t(){}return t.extend=function(e){for(var i,r,n,o,s,c,a=arguments.length,u=1;a>u;u++)if(i=arguments[u])for(r in i)n=e[r],o=i[r],e!==o&&(o&&(t.isPlainObject(o)||(s=Array.isArray(o)))?s?(s=!1,e[r]=o.slice()):(c=n&&t.isPlainObject(n)?n:{},e[r]=t.extend(c,o)):void 0!==o&&(e[r]=o));return e},t.isPlainObject=function(e){return"object"!==t.type(e)||e.nodeType||e===window?!1:!e.constructor||t.hasOwn.call(e.constructor.prototype,"isPrototypeOf")},t.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?t.class2type[t.toString.call(e)]||"object":typeof e},t.class2type={},t.toString=t.class2type.toString,t.hasOwn=t.class2type.hasOwnProperty,t}();i.ObjectExtender=r},{}],55:[function(t,e,i){"use strict";var r=function(){function t(t){this.tokenizer=/ (\w+)(?:\/([\w\.]+))? (?:(\([^\)]+\)) )?/gim,this.userAgent=this.detect(" "+(t||navigator.userAgent)+" "),this.isBrowserSupported=this.checkBrowserSupport(this.userAgent.browser,this.userAgent.is)}return t.prototype.detect=function(t){var e=window.XMLHttpRequest,i=this.tokenize(t),r={is:{mobile:!1},browser:{version:6}},n=r.browser,o=i.Mozilla&&i.Mozilla.extra?i.Mozilla.extra:null;r.supports={sendBeacon:!!navigator.sendBeacon,binaryTransport:e&&"withCredentials"in new XMLHttpRequest};if(i.Opera)return n.version=0,n.name="Opera",n.type=1,r;if(i.Edge)return n.type=0,n.name="Edge",n.version=parseInt(i.Edge.value),r.is.mobile=-1!==t.indexOf("Windows Phone; "),r;if(o){var s=void 0,c=o.indexOf("MSIE "),a=o.indexOf("; Trident/"),u=c+a>-1;if(u&&(s=-1!==c?c:o.indexOf("; rv:"),-1!==s))return n.type=7,n.name="Internet Explorer",n.version=parseFloat(o.substr(s+5,3)),r.is.mobile=-1!==o.indexOf("; Touch")||-1!==o.indexOf("; IEMobile/"),r}if(i.Firefox&&i.Firefox.value)return n.type=5,n.name="Firefox",n.version=parseFloat(i.Firefox.value),r.is.mobile=o&&-1!==o.indexOf("Android; "),r;if((i.Chrome&&i.Chrome.value||i.CriOS&&i.CriOS.value)&&!i.Version)return n.type=3,n.name="Chrome",n.version=parseFloat(i.Chrome?i.Chrome.value:i.CriOS.value),r.is.mobile=i.CriOS||o&&-1!==o.indexOf("; Android "),r;if(i.Safari){if(n.name="Safari",o&&-1!==o.indexOf("; Android ")&&i.AppleWebKit&&i.AppleWebKit.value)return n.type=2,n.version=parseFloat(i.AppleWebKit.value),r.is.mobile=!0,r;o&&-1===o.indexOf("Windows")&&i.Version&&i.Version.value&&(n.type=4,n.version=parseFloat(i.Version.value),r.is.mobile=!!i.Mobile)}return r},t.prototype.checkBrowserSupport=function(t,e){return 0===t.type&&!e.mobile||3===t.type&&t.version>=9||2===t.type&&t.version>=534||5===t.type&&t.version>=25&&!e.mobile||4===t.type&&t.version>=5.1&&t.version<=10||7===t.type&&t.version>9&&!e.mobile},t.prototype.tokenize=function(t){for(var e,i={};e=this.tokenizer.exec(t);)i[e[1]]={value:e[2],extra:e[3]},this.tokenizer.lastIndex--;return i},t}();i.UserAgentService=r},{}],56:[function(t,e,i){"use strict";var r=function(){function t(t){this.settings=t}return t.prototype.onRequestSuccess=function(t){this.reset(),this.settings.sendPromise.resolve(t)},t.prototype.onRequestFailure=function(t){var e=this;this.reset(),setTimeout(function(){e.settings.sendPromise.reject(t)},this.settings.waitInterval)},t}();i.AbstractTransportChannel=r},{}],57:[function(t,e,i){"use strict";var r=function(){function t(t){this.settings=t}return t.prototype.send=function(t,e){var i=e.message.data;navigator.sendBeacon(t+"&"+i)?this.settings.sendPromise.resolve(e):this.settings.sendPromise.reject(e)},t}();i.BeaconTransportChannel=r},{}],58:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./AbstractTransportChannel"),o=function(t){function e(e){t.call(this,e),this.image=new Image}return r(e,t),e.prototype.send=function(t,e){var i=this,r=e.message.data;this.image.onload=function(){i.onRequestSuccess(e)},this.image.onerror=function(){i.onRequestFailure(e)},this.image.src+=t+"&"+r+"&r="+Date.now()},e.prototype.reset=function(){this.image=this.image.onerror=this.image.onload=null},e}(n.AbstractTransportChannel);i.ImageTransportChannel=o},{"./AbstractTransportChannel":56}],59:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./AbstractTransportChannel"),o=function(t){function e(e){t.call(this,e),this.xhr=new XMLHttpRequest}return r(e,t),e.prototype.send=function(t,e){var i=this,r=this.xhr,n=e.message.data;try{r.open("POST",t),r.timeout=3e4,r.setRequestHeader("Content-Type","text/plain"),this.xhr.onreadystatechange=function(){4===r.readyState&&(200===r.status?i.onRequestSuccess(e):i.onRequestFailure(e))},r.onload=function(){i.onRequestSuccess(e)},r.onerror=r.ontimeout=r.onabort=function(){i.onRequestFailure(e)},r.send(n)}catch(o){this.onRequestFailure(e)}},e.prototype.reset=function(){this.xhr=this.xhr.onabort=this.xhr.ontimeout=this.xhr.onerror=this.xhr.onload=this.xhr.onreadystatechange=null},e}(n.AbstractTransportChannel);i.TransportChannelXhr=o},{"./AbstractTransportChannel":56}]},{},[2])(2)}),"function"==typeof window.ClickTaleMonitorOnReady&&ClickTaleMonitorOnReady()}();